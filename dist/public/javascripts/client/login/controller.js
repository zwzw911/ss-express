var indexApp=angular.module("indexApp",["inputDefineApp","generalFuncApp"]);indexApp.factory("userServiceHttp",["$http",function(a){var b=function(b,c,d,e){return a.post("login/loginUser",{name:b,pwd:c,captcha:d,rememberMe:e},{})};return{loginUser:b}}]),indexApp.factory("regenCaptchaService",["$http",function(a){var b=function(){return a.post("login/regen_captcha",{})};return{regen:b}}]),indexApp.controller("LoginController",["$scope","$filter","userServiceHttp","regenCaptchaService","$window","$location","inputDefine","func",function(a,b,c,d,e,f,g,h){console.log(a.rememberMe);a.loging=!1,a.regening=!1,a.login={items:[{value:"",blur:!1,focus:!0,itemName:"name",itemType:"text",itemIcon:"fa-user",itemLabelName:"用户名",itemExist:!1,valid:void 0,msg:""},{value:"",blur:!1,focus:!0,itemName:"password",itemType:"password",itemIcon:"fa-lock",itemLabelName:"密码",itemExist:!1,valid:void 0,msg:""}],captcha:{value:"",blur:!1,focus:!0,itemName:"captcha",itemExist:!1,valid:void 0,msg:""},wholeMsg:{msg:"",show:!1},captchaUrl:""},a.inputBlurFocus=function(a,b,c){if(a.blur=b,a.focus=c,a.valid=void 0,a.msg="",b){var d=a.itemName;if(g.user[d].require.define&&(void 0===a.value||null===a.value||""===a.value))return a.valid=!1,a.msg=g.user[d].require.msg,!1;if(!g.user[d].type.define.test(a.value))return a.valid=!1,a.msg=g.user[d].type.msg,!1;a.valid=!0}},a.loginUser=function(){if(!1===a.login.items[0].valid||!1===a.login.items[1].valid||!1===a.login.captcha.valid)return a.errorModal=h.showErrMsg("填写的信息有误，更正后重试"),!1;a.login.items[0].msg="",a.login.items[0].valid=void 0,a.login.items[1].msg="",a.login.items[1].valid=void 0,a.login.captcha.msg="",a.login.captcha.valid=void 0,a.login.wholeMsg.msg="",a.login.wholeMsg.show=!1,a.loging=!0;var b=c.loginUser(a.login.items[0].value,a.login.items[1].value,a.login.captcha.value,a.rememberMe);b.success(function(b,c,d,f){return 0===b.rc?(a.errorModal=h.showInfoMsg("登录成功，正在跳转"),e.location.href="main",!0):10002==b.rc||10004===b.rc?(a.login.items[0].msg=b.msg,a.login.items[0].valid=!1,a.captchaUrl=b.url,a.loging=!1,!1):10006==b.rc||10008===b.rc?(a.login.items[1].msg=b.msg,a.login.items[1].valid=!1,a.captchaUrl=b.url,a.loging=!1,!1):10042==b.rc||10044===b.rc||40102===b.rc||40108===b.rc?(a.login.captcha.msg=b.msg,a.login.captcha.valid=!1,a.captchaUrl=b.url,a.loging=!1,!1):30018==b.rc?(a.login.wholeMsg.msg=b.msg,a.login.wholeMsg.valid=!1,a.captchaUrl=b.url,a.loging=!1,!1):(a.loging=!1,void(a.errorModal=h.showErrMsg(b.msg)))})},a.regen=function(){a.regening=!0;var b=d.regen();b.success(function(b,c,d,e){0===b.rc?a.captchaUrl=b.url:a.errorModal=h.showErrMsg(b.msg),a.regening=!1})}}]);