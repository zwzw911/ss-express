var app=angular.module("app",["inputDefineApp","generalFuncApp"]);app.factory("checkUserService",["$http",function(a){var b=function(b){return a.post("register/checkUser",{name:b},{})},c=function(b){return a.post("register/checkPhone",{name:b},{})},d=function(b,c,d){return a.post("register/addUser",{name:b,password:c,repassword:d},{})};return{checkUser:b,checkMobilePhone:c,addUser:d}}]),app.controller("RegisterController",["$scope","checkUserService","$window","inputDefine","func",function(a,b,c,d,e){a.commonItems=[{name:"name",type:"text",value:"",itemLabelName:"用户名",blur:!1,focus:!0,valid:void 0,msg:""},{name:"password",type:"password",value:"",itemLabelName:"密码",blur:!1,focus:!0,valid:void 0,msg:""},{name:"repassword",type:"password",value:"",itemLabelName:"重复密码",blur:!1,focus:!0,valid:void 0,msg:""}],a.vendorItems=[{name:"name",type:"text",value:"",itemClass:"",itemLabelName:"用户名",required:!0,minLength:2,maxLength:20,blur:!1,focus:!0,valid:!1,invalid:!1,msg:"",msgShow:!1},{name:"password",type:"password",value:"",itemClass:"",itemLabelName:"密码",required:!0,minLength:2,maxLength:20,blur:!1,focus:!0,valid:!1,invalid:!1,msg:"",msgShow:!1},{name:"repassword",type:"password",value:"",itemClass:"",itemLabelName:"重复密码",required:!0,minLength:2,maxLength:20,blur:!1,focus:!0,valid:!1,invalid:!1,msg:"",msgShow:!1},{name:"mobilePhone",type:"text",value:"",itemClass:"",itemLabelName:"手机号",required:!0,minLength:11,maxLength:13,blur:!1,focus:!0,valid:!1,invalid:!1,msg:"",msgShow:!1}],a.items=a.commonItems,a.inputFocusBlur=function(c,e,f){if(c.blur=f,c.focus=e,c.valid=void 0,c.msg="",f){var g;switch(c.name){case"name":g=JSON.stringify(a.form_register.name.$error);break;case"password":g=JSON.stringify(a.form_register.password.$error);break;case"repassword":g=JSON.stringify(a.form_register.repassword.$error);break;case"mobilePhone":g=JSON.stringify(a.form_register.mobilePhone.$error)}if("{}"!=g)return c.valid=!1,!1;if(c.valid=!0,"name"===c.name){var h=c.value,i=b.checkUser(h);i.success(function(a,b,d,e){0!=a.rc&&(c.valid=!1,c.msg=a.msg)})}"password"===c.name&&(d.user.password.type.define.test(c.value)||(c.valid=!1,c.msg=d.user.password.type.msg)),"repassword"===c.name&&(""===c.value&&(c.valid=!1),c.value!=a.items[1].value&&(c.valid=!1,c.msg=d.user.rePassword.equal.msg))}},a.addUser=function(){a.commonItems.forEach(function(a){return 0==a.valid?!1:void 0});var d=a.items[0].value,f=a.items[1].value,g=a.items[2].value,h=b.addUser(d,f,g);h.success(function(b,d,f,g){0===b.rc?c.location.href="main":a.errorModal=e.showErrMsg(b.msg)})}}]);